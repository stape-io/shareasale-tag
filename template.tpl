___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "ShareASale",
  "brand": {
    "id": "brand_dummy",
    "displayName": "Custom Template",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "ShareASale server to server conversion tracking",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "RADIO",
    "name": "type",
    "displayName": "Event Type",
    "radioItems": [
      {
        "value": "page_view",
        "displayValue": "PageView"
      },
      {
        "value": "conversion",
        "displayValue": "Conversion"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "page_view",
    "help": "\u003cb\u003ePageView\u003c/b\u003e - stores the {sscid} URL parameter inside the __sscid cookie\u003cbr\u003e\u003cbr\u003e\n\u003cb\u003eConversion\u003c/b\u003e - Send request with data about the conversion to the ShareASale"
  },
  {
    "type": "TEXT",
    "name": "clickIdParameterName",
    "displayName": "Url parameter name",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "page_view",
        "type": "EQUALS"
      }
    ],
    "defaultValue": "sscid"
  },
  {
    "type": "GROUP",
    "name": "conversionGroup",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "TEXT",
        "name": "merchantID",
        "displayName": "Merchant ID",
        "simpleValueType": true,
        "help": "Your Merchant ID (XXXXX), which can be found in the top left corner of your ShareASale account.",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "transtype",
        "displayName": "Transaction Type",
        "simpleValueType": true,
        "help": "The transtype parameter is simply set to \u0027lead\u0027 or \u0027sale\u0027 for all lead tracking pixels.",
        "defaultValue": "sale"
      },
      {
        "type": "TEXT",
        "name": "amount",
        "displayName": "Amount",
        "simpleValueType": true,
        "help": "The amount parameter must be passed with a hard-coded zero amount formatted to two decimal places."
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "conversion",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "consentSettingsGroup",
    "displayName": "Consent Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "adStorageConsent",
        "displayName": "",
        "radioItems": [
          {
            "value": "optional",
            "displayValue": "Send data always"
          },
          {
            "value": "required",
            "displayValue": "Send data in case marketing consent given"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "optional"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "logsGroup",
    "displayName": "Logs Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "logType",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log"
          },
          {
            "value": "debug",
            "displayValue": "Log to console during debug and preview"
          },
          {
            "value": "always",
            "displayValue": "Always log to console"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "debug"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "conversion",
        "type": "EQUALS"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const sendHttpRequest = require('sendHttpRequest');
const setCookie = require('setCookie');
const parseUrl = require('parseUrl');
const JSON = require('JSON');
const getRequestHeader = require('getRequestHeader');
const encodeUriComponent = require('encodeUriComponent');
const getCookieValues = require('getCookieValues');
const getAllEventData = require('getAllEventData');
const logToConsole = require('logToConsole');
const getContainerVersion = require('getContainerVersion');
const makeString = require('makeString');
const makeNumber = require('makeNumber');

const containerVersion = getContainerVersion();
const isDebug = containerVersion.debugMode;
const isLoggingEnabled = determinateIsLoggingEnabled();
const traceId = getRequestHeader('trace-id');
const eventData = getAllEventData();

if (!isConsentGivenOrNotRequired()) {
  return data.gtmOnSuccess();
}

if (data.type === 'page_view') {
  const url = eventData.page_location || getRequestHeader('referer');

  if (url) {
    const value = parseUrl(url).searchParams[data.clickIdParameterName];

    if (value) {
      const options = {
        domain: 'auto',
        path: '/',
        secure: true,
        httpOnly: false,
        'max-age': 86400 * 395
      };

      setCookie('__sscid', value, options, false);
    }
  }

  data.gtmOnSuccess();
} else {
  const requestUrl = getRequestUrl();

  if (isLoggingEnabled) {
    logToConsole(
      JSON.stringify({
        Name: 'ShareASale',
        Type: 'Request',
        TraceId: traceId,
        EventName: 'Conversion',
        RequestMethod: 'GET',
        RequestUrl: requestUrl
      })
    );
  }

  sendHttpRequest(
    requestUrl,
    (statusCode, headers, body) => {
      if (isLoggingEnabled) {
        logToConsole(
          JSON.stringify({
            Name: 'ShareASale',
            Type: 'Response',
            TraceId: traceId,
            EventName: 'Conversion',
            ResponseStatusCode: statusCode,
            ResponseHeaders: headers,
            ResponseBody: body
          })
        );
      }

      if (statusCode >= 200 && statusCode < 303) {
        data.gtmOnSuccess();
      } else {
        data.gtmOnFailure();
      }
    },
    { method: 'GET' }
  );
}

function getRequestUrl() {
  let requestUrl = 'https://www.shareasale.com/sale.cfm?v=stape';
  requestUrl = requestUrl + '&transtype=' + enc(data.transtype);
  requestUrl = requestUrl + '&merchantID=' + enc(data.merchantID);

  let amount = data.amount || eventData.amount || eventData.value;
  if (amount) {
    requestUrl = requestUrl + '&amount=' + enc(makeNumber(amount));
  }

  const cookie = getCookieValues('__sscid')[0] || '';
  if (cookie) {
    requestUrl = requestUrl + '&tracking=' + enc(cookie);
  }

  return requestUrl;
}

function enc(data) {
  data = data || '';
  return encodeUriComponent(makeString(data));
}

function determinateIsLoggingEnabled() {
  if (!data.logType) {
    return isDebug;
  }

  if (data.logType === 'no') {
    return false;
  }

  if (data.logType === 'debug') {
    return isDebug;
  }

  return data.logType === 'always';
}

function isConsentGivenOrNotRequired() {
  if (data.adStorageConsent !== 'required') return true;
  if (eventData.consent_state) return !!eventData.consent_state.ad_storage;
  const xGaGcs = eventData['x-ga-gcs'] || ''; // x-ga-gcs is a string like "G110"
  return xGaGcs[2] === '1';
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "trace-id"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "referer"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "__sscid"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "__sscid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://www.shareasale.com/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 12/27/2024, 2:09:33 PM


